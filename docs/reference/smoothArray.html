<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Apply iterative smoothing to Vesalius images — smoothArray • vesalius</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Apply iterative smoothing to Vesalius images — smoothArray"><meta property="og:description" content="Apply iterative smoothing to Vesalius images"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vesalius</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/vesalius.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Vesalius_Analysis/Vesalius_analysis.html">Vesalius Manuscript Analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/patrickCNMartin/Vesalius/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Apply iterative smoothing to Vesalius images</h1>
    <small class="dont-index">Source: <a href="https://github.com/patrickCNMartin/Vesalius/blob/main/R/IsolatingTerritories.R" class="external-link"><code>R/IsolatingTerritories.R</code></a></small>
    <div class="hidden name"><code>smoothArray.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Apply iterative smoothing to Vesalius images</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">smoothArray</span><span class="op">(</span></span>
<span>  <span class="va">image</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"median"</span>, <span class="st">"iso"</span>, <span class="st">"box"</span><span class="op">)</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  box <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  neuman <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  gaussian <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  acrossLevels <span class="op">=</span> <span class="st">"min"</span>,</span>
<span>  invert <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>image</dt>
<dd><p>a Vesalius data frame
(containing at least barcodes, x, y, cc, value) or a cimg object.</p></dd>


<dt>method</dt>
<dd><p>character describing smoothing method to use "median" ,
"iso"  or "box"</p></dd>


<dt>iter</dt>
<dd><p>numeric - number of smoothing iteration</p></dd>


<dt>sigma</dt>
<dd><p>numeric - standard deviation associated with isoblur (Gaussian)</p></dd>


<dt>box</dt>
<dd><p>numeric describing box size (centered around center pixel)
for smoothing</p></dd>


<dt>threshold</dt>
<dd><p>numeric - discard pixels that are too low in value (cutoff
threshold only applied in box/median blurs).</p></dd>


<dt>neuman</dt>
<dd><p>logical describing If Neumann boundary conditions should be
used, Dirichlet otherwise (default true, Neumann)</p></dd>


<dt>gaussian</dt>
<dd><p>logical - use gaussian filter</p></dd>


<dt>na.rm</dt>
<dd><p>logical describing if NA values should be removed</p></dd>


<dt>acrossLevels</dt>
<dd><p>character - method used to account for multiple smoothing
levels (see details). Select from: "min","mean", "max"</p></dd>


<dt>invert</dt>
<dd><p>logical - If TRUE, colours will be inverted i.e. 1 - colorValue
(background set to 1 instead of 0).</p></dd>


<dt>verbose</dt>
<dd><p>logical - progress message output.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns a Vesalius data.frame with "barcodes","x","y","cc",
"value","tile",...</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Images produced by Vesalius should be smoothed in order to retrieve
territories. The <code>smoothArray</code> function provides multiple ways to smooth
an image array.</p>
<p>First, consider the smoothing method : median, iso ,or box. Median and box
both require the <code>box</code> argument to be set according to your needs.
Median converts all pixels surronding a center pixel to the median value of
the selected box. Box converts all pixels to the value of the center pixel.
Iso applies a gaussian blur and is modulated by the <code>sigma</code> argument.</p>
<p>Both the <code>box</code> and <code>sigma</code> arguments can take more than one value.
Both may take a vector of positive numeric values. During every smoothing
iteration, Vesalius will map this vector over multiple copies of the image
and summarize the final smoothed image by taking values across different
levels. The levels are: min, max, and mean. Min will take the lowest pixel
value (in all three colour channels) across all levels. Max will take the
the highest pixel value (in all three colour channels) across levels. Mean
will take the average pixel value (in all three colour channels) across
levels.</p>
<p>The optimal smoothing values will depend on the question at hand and which
territories you wish to extract.</p>
<p>NOTE: this function is applied internally in the
<code>iterativeSegmentation.array</code> function.</p>
<p>For more information, we suggest reading through the imager vignette.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vesalius</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Seurat pre-processing</span></span></span>
<span class="r-in"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">NormalizeData</span><span class="op">(</span><span class="va">vesalius</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">FindVariableFeatures</span><span class="op">(</span><span class="va">image</span>, nfeatures <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">ScaleData</span><span class="op">(</span><span class="va">image</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># converting to rgb</span></span></span>
<span class="r-in"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgbPCA.html">rgbPCA</a></span><span class="op">(</span><span class="va">image</span>,slices <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu"><a href="buildImageArray.html">buildImageArray</a></span><span class="op">(</span><span class="va">image</span>, sliceID<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">smoothArray</span><span class="op">(</span><span class="va">image</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># across multiple levels</span></span></span>
<span class="r-in"><span><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">smoothArray</span><span class="op">(</span><span class="va">image</span>,method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iso"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>acrossLevels <span class="op">=</span> <span class="st">"mean"</span>,sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1.5</span>,l <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="imagePlot.html">imagePlot</a></span><span class="op">(</span><span class="va">image</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Patrick C.N. Martin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer></div>

  


  

  </body></html>

