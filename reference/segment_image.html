<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>segment image — segment_image • vesalius</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="segment image — segment_image"><meta name="description" content="segment vesalius images to find initial territories"><meta property="og:description" content="segment vesalius images to find initial territories"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vesalius</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/vesalius.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/patrickCNMartin/Vesalius/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>segment image</h1>
      <small class="dont-index">Source: <a href="https://github.com/patrickCNMartin/Vesalius/blob/main/R/segment_image.R" class="external-link"><code>R/segment_image.R</code></a></small>
      <div class="d-none name"><code>segment_image.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>segment vesalius images to find initial territories</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">segment_image</span><span class="op">(</span></span>
<span>  <span class="va">vesalius_assay</span>,</span>
<span>  dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  embedding <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"kmeans"</span>,</span>
<span>  col_resolution <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  compactness <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  scaling <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  index_selection <span class="op">=</span> <span class="st">"bubble"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-vesalius-assay">vesalius_assay<a class="anchor" aria-label="anchor" href="#arg-vesalius-assay"></a></dt>
<dd><p>a vesalius_assay object</p></dd>


<dt id="arg-dimensions">dimensions<a class="anchor" aria-label="anchor" href="#arg-dimensions"></a></dt>
<dd><p>numeric vector of latent space dimensions to use.</p></dd>


<dt id="arg-embedding">embedding<a class="anchor" aria-label="anchor" href="#arg-embedding"></a></dt>
<dd><p>character string describing which embedding should
be used.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character string for which method should be used for
segmentation. Select from "kmeans", "louvain", "leiden", "slic",
"leiden_slic","louvain_slic","som"</p></dd>


<dt id="arg-col-resolution">col_resolution<a class="anchor" aria-label="anchor" href="#arg-col-resolution"></a></dt>
<dd><p>numeric colour resolution used for segmentation.
(see details)</p></dd>


<dt id="arg-compactness">compactness<a class="anchor" aria-label="anchor" href="#arg-compactness"></a></dt>
<dd><p>numeric - factor defining super pixel compaction.</p></dd>


<dt id="arg-scaling">scaling<a class="anchor" aria-label="anchor" href="#arg-scaling"></a></dt>
<dd><p>numeric - scaling image ration during super pixel
segmentation.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>numeric [0,1] - correlation threshold between
nearest neighbors when generating segments from super pixels.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical - progress message output.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>numeric - number of closest super pixel neighbors to consider
when generating segments from super pixels</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a vesalius_assay object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Applying image segmentation ensures a reduction in colour
complexity.</p>
<p>Vesalius provides 7 different methods for clustering colours and
reducing color complexity: **Kmeans**, **Louvain**, **Leiden**,
**slic**, **leiden_slic**, **louvain_slic**, and **som**</p>
<p>In the case of kmeans clustering the <code>col_resolution</code> argument
shows the number of colours that the images should be reduced to.
In this case, <code>col_resolution</code> should be an integer and
we suggest first looking at values between 3 and 20.</p>
<p>In the case of **leiden** and **louvain** clustering, the
<code>col_resolution</code> is the granularity of the clustering.
In this case, we suggest using values between 0.01 and 1 to start with.
We recommned uisng **louvain** clustering over **leiden** in
this context.</p>
<p>In the case of slic, the col_resolution define the number of starting
points used to generate super pixels. Depending on the number of
points there are in the assay, we suggested using 10<!-- % of the total  -->
number of points as starting point.
For example, if you have  1000 spatial indices, you can set
col_resolution to 100.</p>
<p>The optimal <code>col_resolution</code> will depend on your interest and
biological question at hand. You might be interested in more or less
granular territories. Along with smoothing, the number of segments is
one way to control this granularity.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vesalius</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># First we build a simple object</span></span></span>
<span class="r-in"><span><span class="va">ves</span> <span class="op">&lt;-</span> <span class="fu">build_vesalius_object</span><span class="op">(</span><span class="va">coordinates</span>, <span class="va">counts</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># We can do a simple run</span></span></span>
<span class="r-in"><span><span class="va">ves</span> <span class="op">&lt;-</span> <span class="fu">build_vesalius_embeddings</span><span class="op">(</span><span class="va">ves</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simple smoothing</span></span></span>
<span class="r-in"><span><span class="va">ves</span> <span class="op">&lt;-</span> <span class="fu"><a href="smooth_image.html">smooth_image</a></span><span class="op">(</span><span class="va">ves</span>, dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># quick segmentation</span></span></span>
<span class="r-in"><span><span class="va">ves</span> <span class="op">&lt;-</span> <span class="fu">segment_image</span><span class="op">(</span><span class="va">ves</span>, dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick C.N. Martin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

