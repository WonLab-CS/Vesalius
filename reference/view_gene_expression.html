<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>view_gene_expression — view_gene_expression • vesalius</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="view_gene_expression — view_gene_expression"><meta name="description" content="View gene expression in spatial omics data, in specific territories or
the expression of genes in a subset of cells."><meta property="og:description" content="View gene expression in spatial omics data, in specific territories or
the expression of genes in a subset of cells."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vesalius</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/vesalius.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/patrickCNMartin/Vesalius/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>view_gene_expression</h1>
      <small class="dont-index">Source: <a href="https://github.com/patrickCNMartin/Vesalius/blob/main/R/view_gene_expression.R" class="external-link"><code>R/view_gene_expression.R</code></a></small>
      <div class="d-none name"><code>view_gene_expression.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>View gene expression in spatial omics data, in specific territories or
the expression of genes in a subset of cells.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">view_gene_expression</span><span class="op">(</span></span>
<span>  <span class="va">vesalius_assay</span>,</span>
<span>  genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  norm_method <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  trial <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  territory_1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  territory_2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cells <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  norm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  as_layer <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  with_background <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  cex_pt <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  max_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  return_as_list <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-vesalius-assay">vesalius_assay<a class="anchor" aria-label="anchor" href="#arg-vesalius-assay"></a></dt>
<dd><p>a vesalius_assay object</p></dd>


<dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>character vector containing the genes you wish to
visualise.</p></dd>


<dt id="arg-norm-method">norm_method<a class="anchor" aria-label="anchor" href="#arg-norm-method"></a></dt>
<dd><p>character string - which count matrix should be used.</p></dd>


<dt id="arg-trial">trial<a class="anchor" aria-label="anchor" href="#arg-trial"></a></dt>
<dd><p>character string describing which segmentation trial
to use. Default is "last" which is the last trial used.</p></dd>


<dt id="arg-territory-">territory_1<a class="anchor" aria-label="anchor" href="#arg-territory-"></a></dt>
<dd><p>integer or vector of integers descrbing territories in
group 1 (see details)</p></dd>


<dt id="arg-territory-">territory_2<a class="anchor" aria-label="anchor" href="#arg-territory-"></a></dt>
<dd><p>integer or vector of integers descrbing territories in
group 2 (see details)</p></dd>


<dt id="arg-cells">cells<a class="anchor" aria-label="anchor" href="#arg-cells"></a></dt>
<dd><p>charactor vector containing barcodes/spatial_indices
associated with cell types of interest (see details)</p></dd>


<dt id="arg-norm">norm<a class="anchor" aria-label="anchor" href="#arg-norm"></a></dt>
<dd><p>logical indicating if expression should be min/max normalised</p></dd>


<dt id="arg-as-layer">as_layer<a class="anchor" aria-label="anchor" href="#arg-as-layer"></a></dt>
<dd><p>logical indicating if expression should represented as
a territory/ layer.</p></dd>


<dt id="arg-cex">cex<a class="anchor" aria-label="anchor" href="#arg-cex"></a></dt>
<dd><p>numeric - font size modulator</p></dd>


<dt id="arg-cex-pt">cex_pt<a class="anchor" aria-label="anchor" href="#arg-cex-pt"></a></dt>
<dd><p>numeric point size</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>point transparency</p></dd>


<dt id="arg-return-as-list">return_as_list<a class="anchor" aria-label="anchor" href="#arg-return-as-list"></a></dt>
<dd><p>logical - should plot be returned as simple list
or as a ggplot object (single gene)/ patchwork object (multiple genes)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a ggplot object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Vesalius offers a plotting function that allows you to
visualise gene expression.</p>
<p>This function offers multiple options depending on what you provide.</p>
<p>1. Overall expression
You can visualise the overall expression pattern of a set of genes
by providing a vesalius_assay object containing counts.
If <code>as_layer</code> is set to FALSE this will show the expression at
each sptial index indivdually. If set to TRUE, this will show the
average expression on a gene in all territories present.</p>
<p>2. Expression in a territory
You can visualise the expression of a gene in an isolated territory.</p>
<p>3. Expression of cells in one or more territory
If you want to visualise the expression of specific cells, you can
parse a character vector containing your cells of interest. This
function will automatically subset the relevant territory data and
show the expression only in the spatial indeces hat are associated
with your cell type of interest. You can use this option to contrast
the expression of cells between territories by also providing which
territories you wish to contrast (`territory_1` and `territory_2`).
If only a single territory is provided, vesalius will only shows cell
in that territory.</p>
<p>If you provide more than one gene, `view_gene_expression` will return
a ggarrange list containing all your genes as individual plots.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vesalius</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># First we build a simple object</span></span></span>
<span class="r-in"><span><span class="va">ves</span> <span class="op">&lt;-</span> <span class="fu">build_vesalius_object</span><span class="op">(</span><span class="va">coordinates</span>, <span class="va">counts</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># We can do a simple run</span></span></span>
<span class="r-in"><span><span class="va">ves</span> <span class="op">&lt;-</span> <span class="fu">build_vesalius_embeddings</span><span class="op">(</span><span class="va">ves</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simple smoothing</span></span></span>
<span class="r-in"><span><span class="va">ves</span> <span class="op">&lt;-</span> <span class="fu"><a href="smooth_image.html">smooth_image</a></span><span class="op">(</span><span class="va">ves</span>, dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># quick segmentation</span></span></span>
<span class="r-in"><span><span class="va">ves</span> <span class="op">&lt;-</span> <span class="fu"><a href="segment_image.html">segment_image</a></span><span class="op">(</span><span class="va">ves</span>, dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># isolate territories</span></span></span>
<span class="r-in"><span><span class="va">ves</span> <span class="op">&lt;-</span> <span class="fu"><a href="isolate_territories.html">isolate_territories</a></span><span class="op">(</span><span class="va">ves</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># view over all expression</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">view_gene_expression</span><span class="op">(</span><span class="va">ves</span>, genes <span class="op">=</span> <span class="st">"Malat1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">view_gene_expression</span><span class="op">(</span><span class="va">ves</span>, genes <span class="op">=</span> <span class="st">"Malat1"</span>, as_layer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># view expression in isolated territory </span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">view_gene_expression</span><span class="op">(</span><span class="va">ves</span>, genes <span class="op">=</span> <span class="st">"Malat1"</span>, territory_1 <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># view expression of cells</span></span></span>
<span class="r-in"><span><span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu"><a href="get_counts.html">get_counts</a></span><span class="op">(</span><span class="va">ves</span><span class="op">)</span><span class="op">)</span>,<span class="fl">300</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">view_gene_expression</span><span class="op">(</span><span class="va">ves</span>,</span></span>
<span class="r-in"><span> genes <span class="op">=</span> <span class="st">"Malat"</span>,</span></span>
<span class="r-in"><span> cells <span class="op">=</span> <span class="va">cells</span>,</span></span>
<span class="r-in"><span> territory_1 <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span> terriotry_2 <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick C.N. Martin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

